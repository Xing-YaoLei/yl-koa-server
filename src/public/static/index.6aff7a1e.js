import{r as e,a8 as a,_ as l,a as t,U as n,m as o,e as r,ad as u,o as d,f as i,h as s,w as p,ae as c,j as m,V as v,i as g,af as h,B as f,ag as b,ah as _,x as C,t as y,E as S}from"./index.8d47e3e0.js";import{u as V,_ as w,b as D}from"./usePagination.218419d2.js";const k={formItems:[{field:"name",label:"部门:",placeholder:"请输入部门名称",type:"input"}]},z=e([{prop:"name",label:"部门名称",isShow:!0,align:"left"},{prop:"description",label:"部门描述",isShow:!0},{prop:"createDateTime",label:"创建时间",isShow:!0},{prop:"createBy",label:"创建人",isShow:!0},{prop:"handle",label:"操作",isShow:!0,custom:!0}]);function P(e){return a({url:"/account/user/department/addDept",method:"post",data:e})}function x(e){return a({url:"/account/user/department/updateDept",method:"post",data:e})}const U={class:"app-container"},F={class:"pager-wrapper"},N={class:"addFleetTitle"},j=l({__name:"index",setup(l){var j;const{paginationData:B,handleCurrentChange:I,handleSizeChange:L}=V(),O=t(!1),T=t(!1),J=t({pid:"",name:"",description:""}),q=t([]),E=t([]),H=t(null),R=t(null),A=t(!1),G=null!=(j=null==k?void 0:k.formItems)?j:[],K={};G.map((e=>{K[e.field]=""}));const M=t(K),Q=t(null),W=e({name:[{required:!0,message:"请输入部门名称",trigger:"blur"},{min:1,max:10,message:"长度应该在1-10之间",trigger:"blur"}]}),X=()=>{var e;null==(e=H.value)||e.resetForm(),te()},Y=()=>{te()},Z=e=>{var l;(l={id:e.row.id},a({url:"/account/user/department/deleteDept",method:"delete",params:l})).then((()=>{te()}))},$=()=>{var e;null==(e=R.value)||e.validate().then((e=>{if(!e)return!1;{const e=A.value?x:P;J.value.pid&&(J.value.pid=J.value.pid[J.value.pid.length-1]),e(J.value).then((e=>{const{rspCode:a,rspData:l}=e;1==a&&(T.value=!1,te(),S({type:"success",message:l}))}))}}))},ee=()=>{J.value={}},ae=()=>{ne(),T.value=!0,A.value=!1},le=e=>{},te=()=>{var e;O.value=!0,(e={...M.value,pageNum:B.currentPage,pageSize:B.pageSize},a({url:"/account/user/department/findList",method:"post",data:e})).then((e=>{O.value=!1;const{pageNum:a,total:l,list:t}=e.rspData;B.currentPage=a,B.total=l,E.value=t}))},ne=()=>{var e;a({url:"/account/user/department/deptTree",method:"post",data:e}).then((e=>{q.value=null==e?void 0:e.rspData}))},oe={checkStrictly:!0,value:"id",label:"name",children:"children"};return n((()=>{ne()})),o([()=>B.currentPage,()=>B.pageSize],te,{immediate:!0}),(e,a)=>{const l=r("el-button"),t=r("el-popconfirm"),n=r("el-pagination"),o=r("el-card"),S=r("el-cascader"),V=r("el-form-item"),P=r("el-input"),x=r("el-form"),j=r("el-dialog"),G=u("loading");return d(),i("div",U,[s(w,c(m(k),{modelValue:M.value,"onUpdate:modelValue":a[0]||(a[0]=e=>M.value=e),ref_key:"editForm",ref:H}),{lastBtn:p((()=>[s(l,{type:"primary",icon:m(h),onClick:Y},{default:p((()=>[f("查询")])),_:1},8,["icon"]),s(l,{icon:m(b),onClick:X},{default:p((()=>[f("重置")])),_:1},8,["icon"])])),_:1},16,["modelValue"]),v((d(),g(o,null,{default:p((()=>[s(D,{tableData:E.value,columnList:m(z)},{OtherHandle:p((()=>[s(l,{icon:m(_),type:"primary",onClick:ae},{default:p((()=>[f("新增")])),_:1},8,["icon"])])),handle:p((e=>[s(l,{type:"primary",link:"",onClick:a=>{var l;return((e,a)=>{Q.value=0!==a,Q.value,ne(),T.value=!0,A.value=!0,J.value=JSON.parse(JSON.stringify(e.row))})(e,null==(l=e.row.children)?void 0:l.length)}},{default:p((()=>[f("编辑")])),_:2},1032,["onClick"]),s(t,{title:"确定删除?",onConfirm:a=>Z(e)},{reference:p((()=>{var a;return[s(l,{type:"danger",link:"",disabled:0!==(null==(a=e.row.children)?void 0:a.length)},{default:p((()=>[f("删除")])),_:2},1032,["disabled"])]})),_:2},1032,["onConfirm"])])),_:1},8,["tableData","columnList"]),C("div",F,[s(n,{background:"",layout:m(B).layout,"page-sizes":m(B).pageSizes,total:m(B).total,"page-size":m(B).pageSize,currentPage:m(B).currentPage,onSizeChange:m(L),onCurrentChange:m(I)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])])),_:1})),[[G,O.value]]),s(j,{modelValue:T.value,"onUpdate:modelValue":a[5]||(a[5]=e=>T.value=e),width:"30%",class:"addDepartmentDialog","show-close":!1,onClose:ee},{header:p((()=>[C("div",N,y(A.value?"编辑部门":"新增部门"),1)])),footer:p((()=>[s(l,{type:"default",onClick:a[4]||(a[4]=e=>T.value=!1)},{default:p((()=>[f("取消")])),_:1}),s(l,{type:"primary",onClick:$},{default:p((()=>[f("保存")])),_:1})])),default:p((()=>[s(x,{"label-width":"100px",class:"DepartmentDialog",ref_key:"addFormRef",ref:R,rules:W,model:A.value&&J.value,"status-icon":""},{default:p((()=>[s(V,{label:"上级部门",prop:"pid"},{default:p((()=>[s(S,{modelValue:J.value.pid,"onUpdate:modelValue":a[1]||(a[1]=e=>J.value.pid=e),options:q.value,onChange:le,props:oe,clearable:"",disabled:Q.value},null,8,["modelValue","options","disabled"])])),_:1}),s(V,{label:"部门名称",prop:"name"},{default:p((()=>[s(P,{modelValue:J.value.name,"onUpdate:modelValue":a[2]||(a[2]=e=>J.value.name=e),placeholder:"请输入部门名称"},null,8,["modelValue"])])),_:1}),s(V,{label:"部门描述",prop:"description"},{default:p((()=>[s(P,{modelValue:J.value.description,"onUpdate:modelValue":a[3]||(a[3]=e=>J.value.description=e),placeholder:"请输入部门描述"},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-1b4fe64e"]]);export{j as default};
