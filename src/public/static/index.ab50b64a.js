import{u as e,_ as a,b as l}from"./usePagination.bd041eb4.js";import{r as t,at as o,P as i,a as s,l as n,U as r,m as p,e as u,o as d,f as c,h as m,w as f,ae as h,j as v,au as g,ag as b,B as y,ah as S,ai as w,t as C,x as _,av as N,aw as z,E as T}from"./index.7c4629cc.js";import{g as k}from"./fleet.38d02fa8.js";import{f as P}from"./index.da6fe3e5.js";const D={formItems:[{field:"modelName",type:"cascader",label:"车型:",placeholder:"请输入车型",options:[]},{field:"plateNo",type:"input",label:"车牌号:",placeholder:"请输入车牌号"},{field:"fleet",type:"select",label:"所属车队:",placeholder:"请选择车队",options:[]},{field:"vin",type:"input",label:"车辆识别码(VIN):",placeholder:"请输入"},{field:"fuelType",type:"select",label:"能源类型:",placeholder:"请选择能源类型",options:[]},{field:"status",type:"select",label:"车辆状态:",placeholder:"请选择车辆状态",options:[]},{field:"purchaseTime",label:"购车时间:",placeholder:"购车时间",type:"datepicker",otherOptions:{startPlaceholder:"开始时间",endPlaceholder:"结束时间",type:"daterange"}}]},V=t([{prop:"plateNo",label:"车牌号码",isShow:!0},{prop:"fleet",label:"车队",isShow:!0},{prop:"modelName",label:"车型",isShow:!0},{prop:"bindTbox",label:"是否绑定TBOX",isShow:!0},{prop:"fuelType",label:"能源类型",isShow:!0,custom:!0},{prop:"vin",label:"车辆识别码(VIN)",isShow:!0},{prop:"status",label:"车辆状态",isShow:!0,custom:!0},{prop:"createDatetime",label:"创建时间",isShow:!0},{prop:"createBy",label:"创建人",isShow:!0},{prop:"handle",label:"操作",isShow:!0,custom:!0}]),x={class:"app-container"},j={class:"pager-wrapper"},B={__name:"index",setup(t){var B;const{paginationData:I,handleCurrentChange:O,handleSizeChange:E}=e(),F=o(),{modelOptions:L}=i(F),U=s([]),q=s(),H=null!=(B=null==D?void 0:D.formItems)?B:[],X={},A=s([{value:1,label:"待入库"},{value:2,label:"入库完成"},{value:3,label:"整备完成"}]),G=s(),J=s({1:"待入库",2:"入库完成",3:"整备完成"});H.map((e=>{X[e.field]=""}));const K=s(X),M=()=>{var e;Q(),null==(e=q.value)||e.resetForm()},Q=()=>{Y()},R=n(),W=()=>{R.push({name:"addVehicle"})},Y=()=>{K.value.purchaseTime&&(K.value.purchaseTimeBegin=K.value.purchaseTime[0],K.value.purchaseTimeEnd=K.value.purchaseTime[1]),K.value.modelName&&(K.value.modelName=K.value.modelName[K.value.modelName.length-1]),N({...K.value,pageNum:I.currentPage,pageSize:I.pageSize}).then((e=>{const{pageNum:a,total:l,list:t}=e.rspData;I.currentPage=a,I.total=l,U.value=t}))};return r((()=>{var e;(async()=>{await g().then((e=>{const a={};G.value=null==e?void 0:e.rspData.map((e=>{a[e.id]=e.name})),G.value=a,H.filter((e=>"fuelType"===e.field))[0].options=P(null==e?void 0:e.rspData)}))})(),k({pageSize:100}).then((e=>{H.filter((e=>"fleet"===e.field))[0].options=P(null==e?void 0:e.rspData.data)})),H.filter((e=>"status"===e.field))[0].options=A.value,null==(e=null==D?void 0:D.formItems)||e.map((e=>{"modelName"==e.field&&(e.options=L.value)}))})),p([()=>I.currentPage,()=>I.pageSize],Y,{immediate:!0}),(e,t)=>{const o=u("el-button"),i=u("el-popconfirm"),s=u("el-pagination"),n=u("el-card");return d(),c("div",x,[m(a,h(v(D),{modelValue:K.value,"onUpdate:modelValue":t[0]||(t[0]=e=>K.value=e),ref_key:"editForm",ref:q}),{lastBtn:f((()=>[m(o,{type:"primary",icon:v(b),onClick:Q},{default:f((()=>[y("查询")])),_:1},8,["icon"]),m(o,{type:"primary",icon:v(S),onClick:M},{default:f((()=>[y("重置")])),_:1},8,["icon"]),m(o,{icon:v(S),onClick:M},{default:f((()=>[y("导入")])),_:1},8,["icon"]),m(o,{icon:v(S),onClick:M},{default:f((()=>[y("下载模版")])),_:1},8,["icon"])])),_:1},16,["modelValue"]),m(n,null,{default:f((()=>[m(l,{tableData:U.value,columnList:v(V)},{OtherHandle:f((()=>[m(o,{type:"primary",icon:v(w),onClick:W},{default:f((()=>[y("新增")])),_:1},8,["icon"])])),fuelType:f((e=>{var a;return[y(C(G.value[Number(null==(a=e.row)?void 0:a.fuelType)]),1)]})),status:f((e=>[y(C(J.value[e.row.status]),1)])),handle:f((e=>[m(o,{type:"primary",link:"",onClick:a=>(e=>{R.push({name:"addVehicle",query:{id:e.row.id}})})(e)},{default:f((()=>[y("编辑")])),_:2},1032,["onClick"]),m(i,{title:"确定删除?",onConfirm:a=>(e=>{z({id:e.row.id}).then((e=>{const{rspData:a}=e;Y(),T({type:"success",message:a})}))})(e)},{reference:f((()=>[m(o,{type:"danger",link:""},{default:f((()=>[y("删除")])),_:1})])),_:2},1032,["onConfirm"])])),_:1},8,["tableData","columnList"]),_("div",j,[m(s,{background:"",layout:v(I).layout,"page-sizes":v(I).pageSizes,total:v(I).total,"page-size":v(I).pageSize,currentPage:v(I).currentPage,onSizeChange:v(E),onCurrentChange:v(O)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])])),_:1})])}}};export{B as default};
