import{_ as e,r as a,l,a as s,e as o,o as t,f as i,x as r,h as d,w as n,a4 as u,C as p,j as c,a5 as m,i as g,a6 as v,B as f,t as w,J as y,K as x,G as b,a7 as h,E as _}from"./index.393a9567.js";import{a as z,c as k}from"./FormValidation.dcbc89b2.js";import{s as V}from"./sendSms.e2186384.js";const P=e=>(y("data-v-329e6aa2"),e=e(),x(),e),C={class:"loginPage"},M=P((()=>r("div",{class:"loginLeftPage"},null,-1))),j={class:"loginRightPage"},I={class:"login-card"},R=P((()=>r("div",{class:"title"},"欢迎使用RayAuto",-1))),U=P((()=>r("div",{class:"secondTitle"},"出行行业MaaS服务专家",-1))),D={class:"content"},K={class:"regOrResetPassword"},N=e({__name:"index",setup(e){const y=a({text:"获取验证码",disabled:!1,countDownNumber:60,timer:null}),x=l(),P=s(!0),N=s({account:"",password:"",code:""}),F=s(!1),S=a({account:"",password:"",newPassword:"",code:""}),T={account:[{validator:z,trigger:"change"}],password:[{validator:k,trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"}],newPassword:[{validator:k,trigger:"change"}]},q=()=>{var e;null==(e=N.value)||e.validate((e=>{if(!e)return!1;F.value=!0,b().login(S).then((()=>{x.push({path:"/"})})).catch((()=>{F.value=!1}))}))},A=()=>{var e;null==(e=N.value)||e.validate((e=>{if(!e)return!1;F.value=!0,h(S).then((e=>{1==e.rspCode&&(_.success("密码以修改完成，请尝试重新登录"),setTimeout((()=>{P.value=!0}),2e3))})).catch((()=>{F.value=!1})).finally((()=>{F.value=!1}))}))},B=()=>{V(S).then((e=>{1==e.rspCode&&(_({message:"短信验证码发送成功",type:"success"}),y.disabled=!0,y.timer&&clearInterval(y.timer),y.timer=setInterval((()=>{const e=y.countDownNumber--;y.text=`${e}秒`,e<=0&&(clearInterval(y.timer),y.countDownNumber=60,y.text="重新获取",y.disabled=!1)}),1e3))}))};return(e,a)=>{const l=o("el-input"),s=o("el-form-item"),x=o("el-button"),b=o("el-form"),h=o("router-link");return t(),i("div",C,[M,r("div",j,[r("div",I,[R,U,r("div",D,[d(b,{ref_key:"loginFormRef",ref:N,"label-position":"top",model:S,rules:T,onKeyup:u(q,["enter"])},{default:n((()=>[d(s,{size:"large",label:"账号",prop:"account"},{default:n((()=>[d(l,{"input-style":"font-size:22px",modelValue:S.account,"onUpdate:modelValue":a[0]||(a[0]=e=>S.account=e),modelModifiers:{trim:!0},placeholder:"用户名",type:"text",tabindex:"1","prefix-icon":c(m),size:"large"},null,8,["modelValue","prefix-icon"])])),_:1}),1==P.value?(t(),g(s,{key:0,size:"large",label:"密码",prop:"password"},{default:n((()=>[d(l,{"input-style":"font-size:22px",modelValue:S.password,"onUpdate:modelValue":a[1]||(a[1]=e=>S.password=e),modelModifiers:{trim:!0},placeholder:"密码",type:"password",tabindex:"2","prefix-icon":c(v),size:"large","show-password":""},null,8,["modelValue","prefix-icon"])])),_:1})):p("",!0),0==P.value?(t(),g(s,{key:1,size:"large",label:"密码",prop:"newPassword"},{default:n((()=>[d(l,{"input-style":"font-size:22px",modelValue:S.newPassword,"onUpdate:modelValue":a[2]||(a[2]=e=>S.newPassword=e),modelModifiers:{trim:!0},placeholder:"请输入新密码",type:"password",tabindex:"2","prefix-icon":c(v),size:"large","show-password":""},null,8,["modelValue","prefix-icon"])])),_:1})):p("",!0),d(s,{size:"large",label:"验证码",prop:"code"},{default:n((()=>[d(l,{"input-style":"font-size:22px",modelValue:S.code,"onUpdate:modelValue":a[3]||(a[3]=e=>S.code=e),modelModifiers:{trim:!0},style:{width:"318px","margin-right":"18px"},placeholder:"请输入验证码"},null,8,["modelValue"]),d(x,{loading:F.value,style:{width:"194px",height:"66px"},type:"primary",size:"large",disabled:y.disabled,onClick:B},{default:n((()=>[f(w(y.text),1)])),_:1},8,["loading","disabled"])])),_:1}),1==P.value?(t(),g(x,{key:2,loading:F.value,name:"login",type:"primary",size:"large",onClick:q},{default:n((()=>[f("登录 ")])),_:1},8,["loading"])):p("",!0),0==P.value?(t(),g(x,{key:3,prop:"newPassword",loading:F.value,name:"login",type:"primary",size:"large",onClick:A},{default:n((()=>[f("确认 ")])),_:1},8,["loading"])):p("",!0)])),_:1},8,["model","onKeyup"])]),r("div",K,[d(h,{to:"/register"},{default:n((()=>[f("注册账号")])),_:1}),0!=P.value?(t(),i("a",{key:0,onClick:a[4]||(a[4]=e=>P.value=!P.value)},"忘记密码")):p("",!0),1!=P.value?(t(),i("a",{key:1,onClick:a[5]||(a[5]=e=>P.value=!P.value)},"登录")):p("",!0)])])])])}}},[["__scopeId","data-v-329e6aa2"]]);export{N as default};
